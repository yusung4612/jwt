<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <title>ì§ì› List</title>

    <style>
        tr {
            border: 1px solid #444444;
        }

        th {
            border: 1px solid #444444;
        }

        td {
            border: 1px solid #444444;
        }

    </style>

    <script>
        $(document).ready(function () {
            // ì „ì²´ ì§ì› ì¡°íšŒ
            $.ajax({
                type: "GET",
                contentType: "application/json; charset=utf-8",
                url: "http://localhost:8080/api/employees/all",
                data: JSON.stringify,
                dataType: 'json',
                success: function (response) {
                    let list = response.employee;
                    let htmlArr = [];
                    for (let i = 0, length = list.length; i < length; i++) {
                        let item = list[i];
                        let cnt = i + 1;
                        htmlArr.push('<tr>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="Number" data-id="' + item.id + '">' + cnt + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.name + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.division + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.department + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.birth + '</label><br>');
                        htmlArr.push('</td>');
                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.extension_number + '</label><br>');
                        htmlArr.push('</td>');
                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.mobile_number + '</label><br>');
                        htmlArr.push('</td>');
                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.email + '</label><br>');
                        htmlArr.push('</td>');

                        // htmlArr.push('<td>');
                        // htmlArr.push('<button type="button" class="employeeUpdate" id="employeeUpdate' + item.id + '" value="' + item.id + '">ìˆ˜ì •<br>');
                        // htmlArr.push('</td>');
                        //
                        // htmlArr.push('<td>');
                        // htmlArr.push('<button type="button" class="employeeDelete" id="employeeDelete' + item.id + '" value="' + item.id + '">ì‚­ì œ<br>');
                        // htmlArr.push('</td>');

                        htmlArr.push('</tr>');
                    }

                    $('#tbodyEmployeeAll').html(htmlArr.join(''));
                    console.log(response);

                },
                error: function (e) {
                    alert("Error: " + e.responseText);
                }
            });

            // ì§ì› ê²€ìƒ‰
            $(document).ready(function () {
                $("#searchEmpForm").submit(function (event) {
                    event.preventDefault(); // í¼ ì „ì†¡ ë°©ì§€

                    let keyword = $("#keywordInput").val(); // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°
                    // var keyword = $("#searchKeyword").val(); // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°

                    $.ajax({
                        type: "GET",
                        contentType: "application/json; charset=utf-8",
                        url: "http://localhost:8080/api/employees/search?keyword=" + keyword,
                        data: JSON.stringify,
                        // data: { keyword: keyword }, // ê²€ìƒ‰ì–´ë¥¼ URL parameterë¡œ ì „ë‹¬
                        dataType: 'json',
                        success: function (response) {
                            if (response.success === true) {
                                // ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ë¶€ë¶„
                                let searchResultTableBody = $("#searchResultTable tbody");
                                searchResultTableBody.empty(); // ê¸°ì¡´ ê²€ìƒ‰ ê²°ê³¼ ì‚­ì œ

                                for (let i = 0; i < response.data.length; i++) {
                                    let emp = response.data[i];
                                    let row = $("<tr></tr>");

                                    row.append($("<td></td>").text(emp.name));
                                    row.append($("<td></td>").text(emp.division));
                                    row.append($("<td></td>").text(emp.department));
                                    row.append($("<td></td>").text(emp.birth));
                                    row.append($("<td></td>").text(emp.extension_number));
                                    row.append($("<td></td>").text(emp.mobile_number));
                                    row.append($("<td></td>").text(emp.email));

                                    searchResultTableBody.append(row);
                                }
                            } else {
                                alert('ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.')
                            }
                        },
                        error: function (e) {
                            alert("Error: " + e.responseText);
                        }
                    });
                });
            });
        });


        //                     if (response.success === true) {
        //                         alert("ê²€ìƒ‰ ì„±ê³µ");
        //                         // window.location.href = 'http://localhost:8080/login.html';
        //                     } else {
        //                         alert('ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.')
        //                     }
        //                 },
        //                 error: function (e) {
        //                     alert("Error: " + e.responseText);
        //                 }
        //             });
        //         });
        //     });
        // });

    </script>

</head>
<body>

<form id="searchEmpForm" action="">
    <input type="text" name="searchKeyword" id="keywordInput"
           style="border: 0px; margin-left: 30%; margin-top: 5%"
           field="{keyword}" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"/>

    <!--        ê²€ìƒ‰ ë²„íŠ¼-->
    <button type="submit" style="border: 0; background-color: white">ğŸ”</button>
</form>

<div id="searchResult"></div>

<table id="searchResultTable">
    <thead>
    <tr>
        <th>ì´ë¦„</th>
        <th>ìƒìœ„ë¶€ì„œ</th>
        <th>í•˜ìœ„ë¶€ì„œ</th>
        <th>ìƒì¼</th>
        <th>ìœ ì„ ì „í™”ë²ˆí˜¸</th>
        <th>ëª¨ë°”ì¼ë²ˆí˜¸</th>
        <th>ì´ë©”ì¼</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>


<h1 style="margin-left: 25%; margin-top: 5%"> < ì§ì› ì „ì²´ ëª©ë¡ > </h1>
<table style="margin-left: 20%; margin-top: 2%">

    <thead>
    <td>
    <th>ì´ë¦„</th>
    <th>ìƒìœ„ë¶€ì„œ</th>
    <th>í•˜ìœ„ë¶€ì„œ</th>
    <th>ìƒì¼</th>
    <th>ìœ ì„ ì „í™”ë²ˆí˜¸</th>
    <th>ëª¨ë°”ì¼ë²ˆí˜¸</th>
    <th>ì´ë©”ì¼</th>
    </td>
    </thead>
    <tbody id="tbodyEmployeeAll">
    </tbody>
</table>
<a href="main.html"><input type="button" value="Back"></a>

</body>
</html>