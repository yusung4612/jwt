<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--    <link rel="stylesheet" href="./main.css">-->
    <link rel="stylesheet" type="text/css" href="../css/common.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

    <title>ì§ì› ì „ì²´ëª©ë¡</title>
    <style>
        .wrap {
            width: 80%;
            margin: 3% auto;
        }
        .search-box {
            margin-bottom: 5%;
        }
    </style>

    <script>
        $(document).ready(function () {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            var emailId = localStorage.getItem("emailId");
            // A íƒœê·¸ì— ì •ë³´ í‘œì‹œ
            $("#myEmailId").text(emailId);

            // ì „ì²´ ì§ì› ì¡°íšŒ
            $.ajax({
                type: "GET",
                contentType: "application/json; charset=utf-8",
                url: "http://localhost:8080/api/employees/all",
                data: JSON.stringify,
                dataType: 'json',
                success: function (response) {
                    let list = response.member;
                    let htmlArr = [];
                    for (let i = 0, length = list.length; i < length; i++) {
                        let item = list[i];
                        let cnt = i + 1;
                        htmlArr.push('<tr>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="Number" data-id="' + item.id + '">' + cnt + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.name + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.division + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.department + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.birth + '</label><br>');
                        htmlArr.push('</td>');
                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.extension_number + '</label><br>');
                        htmlArr.push('</td>');
                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.mobile_number + '</label><br>');
                        htmlArr.push('</td>');
                        htmlArr.push('<td>');
                        htmlArr.push('<label class="employee" data-id="' + item.id + '">' + item.email + '</label><br>');
                        htmlArr.push('</td>');

                        htmlArr.push('</tr>');
                    }

                    $('#tbodyEmployeeAll').html(htmlArr.join(''));
                    console.log(response);

                },
                error: function (e) {
                    alert("Error: " + e.responseText);
                }
            });

            // ì§ì› ê²€ìƒ‰
            $(document).ready(function () {
                $("#searchResultTable").hide();

                $("#searchEmpForm").submit(function (event) {
                    event.preventDefault(); // í¼ ì „ì†¡ ë°©ì§€

                    let keyword = $("#keywordInput").val(); // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°
                    // var keyword = $("#searchKeyword").val(); // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°

                    if (keyword.trim() === '') { // ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆëŠ” ê²½ìš°
                        alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                        return; // í•¨ìˆ˜ ì¢…ë£Œ
                    }

                    $.ajax({
                        type: "GET",
                        contentType: "application/json; charset=utf-8",
                        url: "http://localhost:8080/api/employees/search?keyword=" + keyword,
                        data: JSON.stringify,
                        // data: { keyword: keyword }, // ê²€ìƒ‰ì–´ë¥¼ URL parameterë¡œ ì „ë‹¬
                        dataType: 'json',
                        success: function (response) {
                            if (response.success === true) {
                                // ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ë¶€ë¶„
                                let searchResultTableBody = $("#searchResultTable tbody");
                                searchResultTableBody.empty(); // ê¸°ì¡´ ê²€ìƒ‰ ê²°ê³¼ ì‚­ì œ

                                if (response.data.length > 0) {
                                    for (let i = 0; i < response.data.length; i++) {
                                        let emp = response.data[i];
                                        let row = $("<tr></tr>");

                                        row.append($("<td></td>").text(i + 1));
                                        row.append($("<td></td>").text(emp.name));
                                        row.append($("<td></td>").text(emp.division));
                                        row.append($("<td></td>").text(emp.department));
                                        row.append($("<td></td>").text(emp.birth));
                                        row.append($("<td></td>").text(emp.extension_number));
                                        row.append($("<td></td>").text(emp.mobile_number));
                                        row.append($("<td></td>").text(emp.email));

                                        searchResultTableBody.append(row);
                                    }
                                    // ê²€ìƒ‰ê²°ê³¼ë¥¼ ë³´ì´ê¸°
                                    $("#searchResultTable").show();
                                } else {
                                    alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                                }
                            } else {
                                alert('ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.')
                            }
                        },
                        error: function (e) {
                            alert("Error: " + e.responseText);
                        }
                    });
                });
            });
        });


    </script>

</head>
<body>
<!-- ìƒë‹¨ navbar -->
<div class="nav-box">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Everybot</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <!--                    <li class="nav-item">-->
                    <!--                        <a class="nav-link active" aria-current="page" href="#">Home</a>-->
                    <!--                    </li>-->
                    <li class="nav-item">
                        <a class="nav-link" href="main.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="empList.html">ì§ì› ì „ì²´ëª©ë¡</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="newsList.html">ë‰´ìŠ¤ í˜ì´ì§€</a>
                    </li>
                </ul>
                <form class="d-flex" style="margin-right: 10px">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                               data-bs-toggle="dropdown" aria-expanded="false">
                                <span id="myEmailId"></span>
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" id="logoutAdmin">ë¡œê·¸ì•„ì›ƒ</a></li>
                                <li><a class="dropdown-item" id="deleteAdmin">íšŒì› íƒˆí‡´</a></li>
                            </ul>
                        </li>
                    </ul>
                </form>
            </div>
        </div>
    </nav>
</div>
<div class="wrap">
    <div class="search-box">
        <form id="searchEmpForm" class="form-inline my-2 my-lg-0" style="margin-right: 20%">
            <div class="row">
                <div class="col-10">
                    <input id="keywordInput" field="{keyword}" class="form-control mr-sm-2" type="search"
                           placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" aria-label="Search">
                </div>
                <div class="col-2">
                    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
                </div>
            </div>
        </form>
    </div>
    <div style="width: 1000px; align-content: center">
        <!--ì§ì› ê²€ìƒ‰ ëª©ë¡-->
        <table id="searchResultTable" class="table">
            <thead class="thead-dark">
            <tr>
                <th>NO</th>
                <th>ì´ë¦„</th>
                <th>ìƒìœ„ë¶€ì„œ</th>
                <th>í•˜ìœ„ë¶€ì„œ</th>
                <th>ìƒì¼</th>
                <th>ìœ ì„ ì „í™”ë²ˆí˜¸</th>
                <th>ëª¨ë°”ì¼ë²ˆí˜¸</th>
                <th>ì´ë©”ì¼</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>

        <!--ì§ì› ì „ì²´ ëª©ë¡-->
        <table class="table">
            <thead class="thead-dark">
            <tr>
                <th>NO</th>
                <th>ì´ë¦„</th>
                <th>ìƒìœ„ë¶€ì„œ</th>
                <th>í•˜ìœ„ë¶€ì„œ</th>
                <th>ìƒì¼</th>
                <th>ìœ ì„ ì „í™”ë²ˆí˜¸</th>
                <th>ëª¨ë°”ì¼ë²ˆí˜¸</th>
                <th>ì´ë©”ì¼</th>
            </tr>
            </thead>
            <tbody id="tbodyEmployeeAll">
            </tbody>
        </table>
        <div id="searchResult"></div>

    </div>
</div>

<!--<form id="searchEmpForm" action="">-->
<!--    <input type="text" name="searchKeyword" id="keywordInput"-->
<!--           style="border: 0px; margin-left: 30%; margin-top: 5%"-->
<!--           field="{keyword}" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"/>-->

<!--    &lt;!&ndash;ê²€ìƒ‰ ë²„íŠ¼&ndash;&gt;-->
<!--    <button type="submit" style="border: 0; background-color: white">ğŸ”</button>-->
<!--</form>-->

<!--<div id="searchResult"></div>-->

<!--<table id="searchResultTable" style="margin-left: 25%">-->
<!--    <thead>-->
<!--    <tr>-->
<!--        <td>-->
<!--        <th>ì´ë¦„</th>-->
<!--        <th>ìƒìœ„ë¶€ì„œ</th>-->
<!--        <th>í•˜ìœ„ë¶€ì„œ</th>-->
<!--        <th>ìƒì¼</th>-->
<!--        <th>ìœ ì„ ì „í™”ë²ˆí˜¸</th>-->
<!--        <th>ëª¨ë°”ì¼ë²ˆí˜¸</th>-->
<!--        <th>ì´ë©”ì¼</th>-->
<!--        </td>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--    </tbody>-->
<!--</table>-->


<!--<h1 style="margin-left: 25%; margin-top: 5%"> < ì§ì› ì „ì²´ ëª©ë¡ > </h1>-->
<!--<table style="margin-left: 20%; margin-top: 2%">-->

<!--    <thead>-->
<!--    <td>-->
<!--    <th>ì´ë¦„</th>-->
<!--    <th>ìƒìœ„ë¶€ì„œ</th>-->
<!--    <th>í•˜ìœ„ë¶€ì„œ</th>-->
<!--    <th>ìƒì¼</th>-->
<!--    <th>ìœ ì„ ì „í™”ë²ˆí˜¸</th>-->
<!--    <th>ëª¨ë°”ì¼ë²ˆí˜¸</th>-->
<!--    <th>ì´ë©”ì¼</th>-->
<!--    </td>-->
<!--    </thead>-->
<!--    <tbody id="tbodyEmployeeAll">-->
<!--    </tbody>-->
<!--</table>-->
<!--<a href="main.html"><input type="button" value="Back"></a>-->


</body>
</html>